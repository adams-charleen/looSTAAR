% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/looSTAAR.R
\name{looSTAAR}
\alias{looSTAAR}
\title{looSTAAR: Leave-One-Out STAAR-O Influence Function (Parallelized)}
\usage{
looSTAAR(genotype_matrix, obj_nullmodel, maf_cutoff = 0.01, n_cores = 4)
}
\arguments{
\item{genotype_matrix}{Matrix of 0/1/2 dosages (samples x variants)}

\item{obj_nullmodel}{Output from fit_null_glm()}

\item{maf_cutoff}{Minor allele frequency cutoff (default = 0.01)}

\item{n_cores}{Number of CPU cores to use for parallel processing (default = 4)}
}
\value{
Data.frame with Variant_ID, Baseline_STAAR_O_pval, LOO_STAAR_O_pval, Delta_log10p
}
\description{
Iteratively removes each variant from the set and reruns STAAR-O
to quantify its influence on the gene-based association p-value.
}
\examples{
\dontrun{
if (requireNamespace("STAAR", quietly = TRUE)) {
  library(STAAR)
  set.seed(123)
  data <- matrix(rbinom(2500000, 2, 0.005), nrow = 5000, ncol = 500)
  colnames(data) <- paste0("var", 1:500)
  pheno_data <- data.frame(y = rnorm(5000))
  null_model <- fit_null_glm(y ~ 1, family = gaussian(), data = pheno_data)
  result <- looSTAAR(data[, 1:20], null_model, maf_cutoff = 0.01, n_cores = 2)
  head(result)
}
}

}
